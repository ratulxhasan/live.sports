
(function(){'use strict';shaka.polyfill.installAll();let a,b,c,d=null;window.matches={football:[],cricket:[]};window.currentTab="cricket";const e={apiKey:"AIzaSyCkLQ5vf1z9dYjAVcOo7tm0BRT8N7jAbOw",authDomain:"ratul-liv.firebaseapp.com",databaseURL:"https://ratul-liv-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"ratul-liv",storageBucket:"ratul-liv.appspot.com",messagingSenderId:"395032456768",appId:"1:395032456768:web:eadef753d410c71c5439a5"};const f=initializeApp(e),g=getDatabase(f);async function h(){a=document.getElementById("video");b=document.getElementById("player-wrapper");c=new shaka.Player(a);const e=new shaka.ui.Overlay(c,b,a);e.configure({controlPanelElements:["play_pause","mute","volume","fullscreen","quality","picture_in_picture"],addSeekBar:!0});let f=await i(),g=300000,maxBandwidth=Math.max(Math.min(f*.75,5e6),5e5);c.configure({drm:{retryParameters:{maxAttempts:10,baseDelay:1e3,backoffFactor:2}},streaming:{bufferingGoal:60,rebufferingGoal:5,bufferBehind:30,skipLargeGaps:!0,lowLatencyMode:!1},abr:{enabled:!0,switchInterval:8,defaultBandwidthEstimate:g,bandwidthUpgradeTarget:.7,bandwidthDowngradeTarget:.9,restrictions:{minBandwidth:3e5,maxBandwidth:maxBandwidth,minWidth:0,maxWidth:1280,minHeight:0,maxHeight:720}},manifest:{retryParameters:{maxAttempts:10,baseDelay:1e3,backoffFactor:2}}});c.addEventListener("error",e=>{const a=e.detail;console.error("üî¥ Stream/DRM Error:",a?.category,a?.code,a?.data||"")})}async function i(){try{const a=performance.now(),b=await fetch("https://www.google.com/images/branding/googlelogo/2x/googlelogo_light_color_92x30dp.png",{cache:"no-cache"}),c=await b.blob(),d=(performance.now()-a)/1e3;return c.size*8/d}catch{return 2e6}}async function j(){try{const a=ref(g,"matches"),b=await get(a),c=b.val()||{};window.matches.football=c.football?Object.values(c.football):[];window.matches.cricket=c.cricket?Object.values(c.cricket):[];document.dispatchEvent(new CustomEvent("firebaseDataReady"))}catch(a){console.error("‚ùå Firebase load error:",a),document.dispatchEvent(new CustomEvent("firebaseDataError"))}}function k(a){const b=document.getElementById(a+"-section");b.innerHTML="";const c=window.matches[a]||[];if(!c.length){b.innerHTML="<div class='no-matches'><h3>No matches</h3></div>";return}c.forEach(c=>{const d=(c.status||"").toLowerCase(),e=d==="live"?"LIVE":d==="ended"?"ENDED":`Starts: ${new Date(c.startTime).toLocaleTimeString()}`,f=d==="live"?"badge live":d==="ended"?"badge ended":"badge schedule",g=document.createElement("div");g.className="match-card-horizontal",g.innerHTML=`<div class="match-title">${c.title||`${c.team1?.name||"Team 1"} vs ${c.team2?.name||"Team 2"}`}</div><div class="match-horizontal"><div class="team"><img src="${c.team1?.logo||""}" class="team-logo-small" alt="${c.team1?.name||"Team 1"}"><div class="team-name-small">${c.team1?.name||"Team 1"}</div></div><div class="vs-section-horizontal"><div class="vs-text">VS</div><div class="${f}" data-status="${d}">${e}</div></div><div class="team"><img src="${c.team2?.logo||""}" class="team-logo-small" alt="${c.team2?.name||"Team 2"}"><div class="team-name-small">${c.team2?.name||"Team 2"}</div></div></div>`,g.addEventListener("click",()=>l(c)),b.appendChild(g)})}async function l(a){const b=document.getElementById("videoSection"),c=document.getElementById("videoTitle"),d=document.getElementById("serverRow");b.style.display="block",c.textContent=`${a.team1?.name||"Team 1"} vs ${a.team2?.name||"Team 2"}`,d.innerHTML="";const e=(a.streams||[]).filter(a=>a&&a.url);localStorage.setItem("lastStreams",JSON.stringify(e)),e.forEach((b,e)=>{const f=document.createElement("button");f.className="server-btn",f.textContent=(b.name||`Server ${e+1}`).trim(),f.dataset.url=b.url,f.dataset.clearkey=b.clearkey?JSON.stringify(b.clearkey):null,f.dataset.type=b.type||"dash",f.addEventListener("click",async()=>{d.querySelectorAll(".server-btn").forEach(a=>a.classList.remove("active","live")),f.classList.add("active"),"live"===((a.status||"").toLowerCase())&&f.classList.add("live"),"iframe"===f.dataset.type?wrapper.innerHTML=`<iframe src="${f.dataset.url}" frameborder="0" allowfullscreen style="width:100%;height:100%;"></iframe>`:c.dataset.clearkey?player.configure({drm:{clearKeys:JSON.parse(f.dataset.clearkey)}}):null,await player.load(f.dataset.url),video.play(),console.log(`‚úÖ Playing: ${f.textContent}`)}),d.appendChild(f)}),d.firstChild&&d.firstChild.click()}function m(a){document.querySelectorAll(".matches-section").forEach(a=>a.classList.add("hidden"));const b=document.getElementById(`${a}-section`);b&&b.classList.remove("hidden"),document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));const c=document.getElementById(`tab${a.charAt(0).toUpperCase()+a.slice(1)}`);c&&c.classList.add("active"),window.currentTab=a}document.getElementById("tabFootball").addEventListener("click",()=>m("football")),document.getElementById("tabCricket").addEventListener("click",()=>m("cricket")),document.addEventListener("firebaseDataReady",()=>{k("football"),k("cricket"),m("cricket"),n("Connected")}),document.addEventListener("firebaseDataError",()=>n("Firebase error"));function n(a){const b=document.getElementById("firebaseStatus");b&&(b.textContent=a,b.style.opacity="1",setTimeout(()=>b.style.opacity=".5",2e3))}const o=document.getElementById("menuBtn"),p=document.getElementById("dropdownMenu");o.addEventListener("click",()=>{p.style.display="block"===p.style.display?"none":"block"}),document.addEventListener("click",a=>{a.target!==o&&!p.contains(a.target)&&(p.style.display="none")});function q(){if(d)return;d=setInterval(()=>{document.querySelectorAll(".badge.schedule,.badge.live").forEach(a=>{const b=(a.dataset.status||"").toLowerCase(),c=a.dataset.start||"";let d=a.textContent;"schedule"===b&&c&&(new Date(c)-new Date()<=0&&(a.dataset.status="live",a.classList.remove("schedule"),a.classList.add("live"),d="LIVE")),a.textContent=d})},1e3)}window.addEventListener("load",async()=>{await h(),await j(),q()})();
