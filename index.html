<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ratul LIV - Live Sports</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<!-- Cloudflare Turnstile -->
<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>

<!-- JW Player -->
<script src="https://ssl.p.jwpcdn.com/player/v/8.33.2/jwplayer.js"></script>
<script>jwplayer.key="cLGMn8T20tGvW+0eXPhq4NNmLB57TrscPjd1IyJF84o=";</script>

<style>
/* RESET */
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Roboto, sans-serif; background: #121212; color: #fff; }

/* HEADER */
.header {
  display: flex; justify-content: space-between; align-items: center;
  background: #1e1e1e; padding: 12px 20px;
  position: sticky; top: 0; z-index: 1000;
}
.logo { font-size: 20px; font-weight: bold; }
.menu-btn { background: none; border: none; color: #fff; font-size: 22px; cursor: pointer; }
.dropdown-menu { display: none; position: absolute; top: 50px; right: 20px; background: #222; border-radius: 8px; }
.dropdown-menu a { display: block; padding: 10px; color: #fff; text-decoration: none; }
.dropdown-menu a:hover { background: #333; }

/* STICKY PLAYER */
.player-container {
  position: -webkit-sticky;
  position: sticky;
  top: 60px; /* header height ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ adjust ‡¶ï‡¶∞‡ßÅ‡¶® */
  z-index: 900;
  background: #000;
}
.video-player {
  width: 100%;
  aspect-ratio: 16/9;
}

/* NAV TABS */
.nav-tabs {
  display: flex; justify-content: center; gap: 10px; margin: 15px 0;
}
.tab-btn {
  padding: 10px 20px; border: none;
  background: #333; color: #fff;
  border-radius: 6px; cursor: pointer;
}
.tab-btn.active { background: #ff4c4c; }

/* MATCH SECTIONS */
.matches-section { padding: 10px; }
.hidden { display: none; }

/* FOOTER */
.footer { text-align: center; padding: 15px; background: #1e1e1e; margin-top: 20px; }

/* FIREBASE STATUS */
.firebase-status { text-align: center; padding: 10px; background: #222; color: #ffcc00; }
</style>
</head>
<body>

<!-- Turnstile overlay -->
<div id="turnstileOverlay">
  <div id="turnstileBox" style="text-align:center;padding:30px;">
    <h4>Verify you're human üé≠ DDOS & BOT security by Cloudflare</h4>
    <div class="cf-turnstile"
         data-sitekey="0x4AAAAAAB0sj0L7hIXQMc2l"
         data-callback="onTurnstileSuccess"></div>
  </div>
</div>

<!-- Main Content -->
<div id="mainContent" style="display:none;">
  <header class="header">
    <div class="logo">Live Sports üáßüá©</div>
    <button class="menu-btn" id="menuBtn"><i class="fas fa-bars"></i></button>
    <div class="dropdown-menu" id="dropdownMenu">
      <a href="https://t.me/+5S-lx5CxGJEwMTdl" target="_blank"><i class="fab fa-telegram-plane"></i> Join Telegram</a>
      <a href="#about">About</a>
      <a href="#contact">Contact</a>
    </div>
  </header>

  <!-- Video Player -->
  <section id="videoSection" style="display:none;">
    <div id="videoTitle" class="featured-title" style="padding:10px;font-size:18px;font-weight:bold;"></div>
    <div class="player-container">
      <div id="jwplayerDiv" class="video-player"></div>
    </div>
    <div id="serverRow" class="server-options" style="padding:10px;"></div>
  </section>

  <!-- Tabs -->
  <nav class="nav-tabs">
    <button class="tab-btn active" id="tabFootball">Football</button>
    <button class="tab-btn" id="tabCricket">Cricket</button>
  </nav>

  <!-- Match Sections -->
  <section id="football-section" class="matches-section"></section>
  <section id="cricket-section" class="matches-section hidden"></section>

  <footer class="footer">&copy; 2025 Ratul liv. All Rights Reserved.üáßüá©</footer>

  <div id="firebaseStatus" class="firebase-status">Initializing...</div>
</div>

<script type="module">
let firebaseInitialized = false;

async function initializeFirebase() {
  if (firebaseInitialized) return;
  firebaseInitialized = true;

  try {
    const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
    const { getDatabase, ref, onValue } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js');

    const firebaseConfig = {
      apiKey: "AIzaSyCkLQ5vf1z9dYjAVcOo7tm0BRT8N7jAbOw",
      authDomain: "ratul-liv.firebaseapp.com",
      databaseURL: "https://ratul-liv-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "ratul-liv",
      storageBucket: "ratul-liv.firebasestorage.app",
      messagingSenderId: "395032456768",
      appId: "1:395032456768:web:eadef753d410c71c5439a5",
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const matchesRef = ref(db, 'matches');

    onValue(matchesRef, (snapshot) => {
      const data = snapshot.val() || {};
      const football = data.football ? Object.values(data.football) : [];
      const cricket = data.cricket ? Object.values(data.cricket) : [];

      function sortMatches(arr) {
        const order = { live: 0, schedule: 1, ended: 2 };
        return arr.slice().sort((a, b) => {
          const sA = (a.status || "schedule").toLowerCase();
          const sB = (b.status || "schedule").toLowerCase();
          if (order[sA] !== order[sB]) return order[sA] - order[sB];
          if (sA === "schedule") return new Date(a.startTime) - new Date(b.startTime);
          if (sA === "ended") return new Date(b.startTime) - new Date(a.startTime);
          return 0;
        });
      }

      window.matches = {
        football: sortMatches(football),
        cricket: sortMatches(cricket)
      };

      document.getElementById('firebaseStatus').textContent = '‚úÖ Matches loaded';
      document.dispatchEvent(new CustomEvent('firebaseDataReady'));
    });

  } catch (e) {
    console.error("Firebase error:", e);
    document.getElementById('firebaseStatus').textContent = '‚ùå Firebase failed';
  }
}

// Turnstile callback
window.onTurnstileSuccess = function(token) {
  document.getElementById("turnstileOverlay").style.display = "none";
  document.getElementById("mainContent").style.display = "block";
  initializeFirebase();
};

// Tab switching
document.getElementById('tabFootball').addEventListener('click', () => {
  document.getElementById('football-section').classList.remove('hidden');
  document.getElementById('cricket-section').classList.add('hidden');
  document.getElementById('tabFootball').classList.add('active');
  document.getElementById('tabCricket').classList.remove('active');
});
document.getElementById('tabCricket').addEventListener('click', () => {
  document.getElementById('cricket-section').classList.remove('hidden');
  document.getElementById('football-section').classList.add('hidden');
  document.getElementById('tabCricket').classList.add('active');
  document.getElementById('tabFootball').classList.remove('active');
});
</script>
</body>
</html>
